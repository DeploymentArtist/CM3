Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Pilot 1" -LimitToCollectionID PS10000B -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "Software Update pilot 1 members"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_Pilot1"' -QueryName "SUM Pilot 1" -QueryType Device -CollectionName "SUM Pilot 1"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Pilot 2" -LimitToCollectionID PS10000B -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "Software Update pilot 2 members"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_Pilot2"' -QueryName "SUM Pilot 2" -QueryType Device -CollectionName "SUM Pilot 2"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Excluded" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Servers and Workstations that should never receive any updates"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Workstation Production" -LimitToCollectionID PS10000B -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All workstations"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.OperatingSystemNameandVersion like "%workstation%"' -QueryName "All WRK" -QueryType Device -CollectionName "SUM Workstation Production"
Set-CMCollectionExcludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Workstation Production" -ExcludeCollectionName "SUM Excluded"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server Manual" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All servers where updates must be manually installed"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_SRV_Manual"' -QueryName "SUM Server Manual" -QueryType Device -CollectionName "SUM Server Manual"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server MW1" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Servers in Maintenance Window 1"
Set-CMCollectionQueryRule -SiteCode PS1  -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_MW1"' -QueryName "SUM Server MW1" -QueryType Device -CollectionName "SUM Server MW1"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server MW2" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Servers in Maintenance Window 2"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_MW2"' -QueryName "SUM Server MW2" -QueryType Device -CollectionName "SUM Server MW2"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server MW3" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Servers in Maintenance Window 3"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.SystemGroupName = "VIAMONSTRA\\SUM_MW3"' -QueryName "SUM Server MW3" -QueryType Device -CollectionName "SUM Server MW3"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server Automatic" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Servers where updates are installed automatically and server restarted according to maintenance windows"
Set-CMCollectionIncludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Automatic" -IncludeCollectionName "SUM Server MW1"
Set-CMCollectionIncludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Automatic" -IncludeCollectionName "SUM Server MW2"
Set-CMCollectionIncludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Automatic" -IncludeCollectionName "SUM Server MW3"
Add-CMCollection -SiteCode PS1 -SiteServer CM01 -Name "SUM Server Non-Managed" -LimitToCollectionID PS10000A -Folder "Software Updates" -Type Device -CustomDay 7 -Incremental -Comment "All Non-managed SUM Servers"
Set-CMCollectionQueryRule -SiteCode PS1 -SiteServer CM01 -Query 'select * from SMS_R_System where SMS_R_System.OperatingSystemNameandVersion like "%Server%"' -QueryName "All SRV" -QueryType Device -CollectionName "SUM Server Non-Managed"
Set-CMCollectionExcludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Non-Managed" -ExcludeCollectionName "SUM Server MW1"
Set-CMCollectionExcludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Non-Managed" -ExcludeCollectionName "SUM Server MW2"
Set-CMCollectionExcludeRule -SiteCode PS1 -SiteServer CM01 -CollectionName "SUM Server Non-Managed" -ExcludeCollectionName "SUM Server MW3"